<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome file</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="қауіпсіздік">Қауіпсіздік</h1>
<p>Мені таптырған ең жақсы PHP қауіпсіздігі туралы ресурс <a href="https://paragonie.com/blog/2017/12/2018-guide-building-secure-php-software">The 2018 Guide to Building Secure PHP Software</a> by <a href="https://paragonie.com/">Paragon Initiative</a>.</p>
<h3 id="веб-қолданба-қауіпсіздігі">Веб Қолданба Қауіпсіздігі</h3>
<p>Әр PHP әзірлеушінің <a href="https://paragonie.com/blog/2015/08/gentle-introduction-application-security">веб қолданба қауіпсіздігінің негіздерін</a> меңгеру — бұл өте маңызды, ол бірнеше көп тақырыппен бөлініп, өзгерту мүмкін:</p>
<ol>
<li>
<p>Код-деректерді бөлу.</p>
<ul>
<li>Деректер код пен екізілгенде, SQL Injection, Cross-Site Scripting, Жергі/Ұқсас Файлды Қосу және т.б. жатамайды.</li>
<li>Код деректер түсірілгенде, ақпаратты талталар алып тастайды (бастама коды көрсетілу немесе C программаларының мысалында ASLR-ды өту үшін көмекші ақпарат достары).</li>
</ul>
</li>
<li>
<p>Бағдарлама логикасы.</p>
<ul>
<li>Аутентификация немесе авторизация бақылаулары болмаса.</li>
<li>Кіру беру тексеруі.</li>
</ul>
</li>
<li>
<p>Іске қосу аулауы.</p>
<ul>
<li>PHP нұсқалары.</li>
<li>Уақытша қолдану көлемдері.</li>
<li>Іске қосу операционды аудандар.</li>
</ul>
</li>
<li>
<p>Криптографиянің недірсіздіктері.</p>
<ul>
<li><a href="https://paragonie.com/blog/2016/01/on-design-and-implementation-stealth-backdoor-for-web-applications">Кедей әрекеттер</a>.</li>
<li><a href="https://paragonie.com/blog/2015/05/using-encryption-and-authentication-correctly">Таңдалған шифрлы тіркеулер</a>.</li>
<li><a href="https://blog.ircmaxell.com/2014/11/its-all-about-time.html">Жаңа алгоритмдерге қарсы жауап беретін мәліметтерді жасау үшін барлық жатамаларға алып тасталмау</a>.</li>
</ul>
</li>
</ol>
<p>Сіздің веб-қолданбаңызды қолданушыларды қолдана алатын және салықты көмекші болатын кедейді адамдар бар. Веб-қолданбаңыздың қауіпсіздігін қамтамасыз ету үшін қажетті сауатты қауіпсіздік заңбын жасау керек. Бағдарлама қолданбасынын сауатты қауіпсіздігі үшін белгіленген барлық білінген қауіпсіздік мәселелері мен олармен өзінізді қорғау әдістері туралы азаматтардың көмекшілері <a href="https://www.owasp.org/">Open Web Application Security Project</a> (OWASP) атауымен жасалған. Бұл, қауіпсіздік білуші өзгертуші үшін міндетті оқу материалдарын біріді. Padraic Brady жасаған “<a href="https://phpsecurity.readthedocs.io/en/latest/index.html">Survive The Deep End: PHP Security</a>” PHP үшін басқа бір жақсы веб-қолданба қауіпсіздігі нұсқаулығыды да танысу үшін өте жақсы руководство болады.</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Guide_Table_of_Contents">OWASP Қауіпсіздік Нұсқаулығын оқыңыз</a></li>
</ul>
<h3 id="парольді-хэшиздеу">Парольді Хэшиздеу</h3>
<p>Көпшілік бір кезде пайдаланушы кіруіне байланысты PHP қолданбасын құруды көреді. Пайдаланушы аты мен парольдері база қорында сақталады және кіреу кезінде пайдаланушыларды аутентификациялау үшін пайдаланылады.</p>
<p>Парольді сақтау алдын, оны дәлелдермен қауіпсіздікке келтіру маңызды. <a href="https://wikipedia.org/wiki/Cryptographic_hash_function">Хэшиздеу</a> мен шифрлау - бұл <a href="https://paragonie.com/blog/2015/08/you-wouldnt-base64-a-password-cryptography-decoded">көпінше білінбейтін</a> көмекші көмекшілер.</p>
<p>Хэшиздеу - бұл айырым айырылмайтын, бір жол жүзейтілген әрекет. Бұл жатты мүмкіндіксіз, бір жол функция. Бұл жатты мүмкіндіксіз, бір жол функция. Бұл, жаңа стрингді жою мүмкін емес бір тіркесіздікке жатты айырымдығын білдіреді. Бұл айырым табана келмейтін бір өлшемді стринг өнімдігін өзгертілу мүмкін болмайды. Бұл, қауіпсіздік байланысын бақылайтын жатты мүмкіндікті стрингпен салыстыру үшін бірін-бірімен салыстыра аласыздар, бірақ сіз асыл стрингті анықтау мүмкін емес. Егер парольдер хэштен өткізілмесе және сіздің базасына жарамсыз жеткізілгенде, барлық пайдаланушы тіркелген.</p>
<p>Хэшиздеудік айырымдан келгенде, шифрлауды терең жеткізу мүмкін (ескі табу жоқ). Шифрлау басқа жайында қолданылады, бірақ парольді қауіпсіздікке сақтау үшін өте жаманды.</p>
<p>Парольдерді қауіпсіздікке сақтау үшін көмекшілігімен өзгеріп алынған кезде көмекші <a href="https://wikipedia.org/wiki/Salt_(cryptography)">стрингті</a> өндіру арқылы бетінді шифрлау көмекшілігін қолдану керек. Бұл сөздік атакаларды және “райы жол” (криптографиялық хэштің көптігіне арналған теріс тізім) пайдалануын алты алады.</p>
<p>Хэшиздеу мен өзгерту көмекшілері пайдаланушылардың көбі ешқандай қызметке бірдей парольді қолданады және пароль сапасы көмекшілігі кем болуы мүмкін.</p>
<p>Сондай-ақ, SHA256 т.б.) жатты мүмкіндік беретін тобыраулардың қош келмейтін, жатты мүмкіндік беретін <a href="https://paragonie.com/blog/2016/02/how-safely-store-password-in-2016">криптографиялық хэштің</a> орыс, бірлескен екіден біріні қолдану қажетіне сәйкес, өзгерту көмекшісін пайдалану керек (мысалы, SHA256). Қолдау көзі берілген (2020 жылдың Желтоқсанның аяқталуы бойынша) қатты мүмкіндік беретін криптографиялық пароль хэши тобы:</p>
<ul>
<li>Argon2 (PHP 7.2 және жаңасында қол жетімді)</li>
<li>Scrypt</li>
<li>Bcrypt (PHP оны сізге ұсынады; төмендегіді көріңіз)</li>
<li>PBKDF2 сауатты HMAC-SHA256 немесе HMAC-SHA512 бірімен</li>
</ul>
<p>Көмекшілікті, бүгінгі кезде PHP бұны оңай қылып жасайды.</p>
<h3 id="парольді-password_hash-арқылы-хэшиздеу">Парольді password_hash арқылы хэшиздеу</h3>
<p>PHP 5.5-та password_hash() қосылды. Осы уақытта ол PHP қолданылатын ең күшті алгоритм - BCrypt пайдаланады. Ол келесіде көбірек алгоритмдерді қолдану үшін жаңартылады. password_compat кітапханасы PHP &gt;= 5.3.7 үшін алдауымдылығын беру үшін жасалды.</p>
<p>Төменде біз стрингті хэштейміз және ондағы хэшті жаңа стрингтімен салыстырамыз. Себебі біздің екі бастау стрингімізді төмендегіден айырып отырмыз (‘secret-password’ сөзі мен ‘bad-password’ сөзі). Бұл кіру таба алмайды.</p>
<pre class=" language-php"><code class="prism  language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token string">'require password.php'</span><span class="token punctuation">;</span>

<span class="token variable">$passwordHash</span> <span class="token operator">=</span> <span class="token function">password_hash</span><span class="token punctuation">(</span><span class="token string">'secret-password'</span><span class="token punctuation">,</span> <span class="token constant">PASSWORD_DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">password_verify</span><span class="token punctuation">(</span><span class="token string">'bad-password'</span><span class="token punctuation">,</span> <span class="token variable">$passwordHash</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Дұрыс Пароль</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Пароль қате</span>
<span class="token punctuation">}</span>
</span></code></pre>
<p>password_hash() сізге парольді солтылау туралы ойлау жасайды. Солт, хэштің бір өлшемі түрінде сақталады және “сайт” мен “ақыл” болып туралыда барлық мәліметтермен бірге. password_verify() осын ойлау жасайтын бойынша солтын табу үшін бұлдан алу үшін өзгерту жолды талап етмейді, сіздің сіздің солттарын сақтау үшін өзгерген кесте деректеріне көмек көрсетілмейді.</p>
<ul>
<li><a href="https://www.php.net/function.password-hash">password_hash() туралы білгі алып түсіздік</a></li>
<li><a href="https://github.com/ircmaxell/password_compat">password_compat для PHP &gt;= 5.3.7 &amp;&amp; &lt; 5.5</a></li>
<li><a href="https://wikipedia.org/wiki/Cryptographic_hash_function">криптография бойынша хэшиздеуді оқу</a></li>
<li><a href="https://wikipedia.org/wiki/Salt_(cryptography)">солттар туралы білім алу</a></li>
<li><a href="https://wiki.php.net/rfc/password_hash">PHP password_hash() RFC</a></li>
</ul>
<h3 id="деректерді-сүзгіту">Деректерді Сүзгіту</h3>
<p>PHP кодына енгізілген сыртқы кірістерге (деректерге) сенімді болмау. Кодда пайдалану алдында сыртқы кірістерді сақтау және тексеру жасау қажет. filter_var() және filter_input() функциялары мәтінді сүзгіттей алады және мәтін форматтарын тексереді (мысалы, электронды пошта мекенжайлары).</p>
<p>Сыртқы кірістерге пайдаланушы арқылы жіберілген форма деректерімен шектеуленген жоқ. Жүктелген және жүктелген файлдар, сессия мәндері, cookie деректері және қосымша веб қызметтердің деректері - бұл де сыртқы кірістер.</p>
<p>Сыртқы деректерді сақтау, біріктіру және кейінірек қолдану күніне сәйкес қолданылады, бірақ ол де сыртқы деректер. Демек, деректерді өңдеу, шығару, біріктіру немесе кодыңызда деректерді қосу кезінде оларды дәлелдермен сызгыттауыңыз көмек етеді.</p>
<p>Қандайда болмаса, сыртқы деректерді дайындау, шығару, біріктіру немесе кодыңызда деректерді қосу кезінде сізге өзіңізді сауал қоюыңыз көмек етеді: деректер дұрыс сүзгіттелген пе және оның сенімді пе болуын тексеру.</p>
<p>Деректерді мақсаты бойынша сызгыту кезінде басқаруы мүмкін. Мысалы, сыртқы кірістерді HTML бетіне шығару кезінде сыртқы деректерге келісімсіз талдау кірістері, сайттыңызда HTML және JavaScript кодты орындау мүмкін! Бұл Cross-Site Scripting (XSS) деп аталады және бұл өте жанаулы хакерлік болары болуы мүмкін. XSS-тан бұрын, оны сайттыңыздан шығармайтында, strip_tags() функциясын пайдалану арқылы HTML тақтасынан тегтерді алауып, htmlentities() немесе htmlspecialchars() функцияларын пайдалану арқылы аламындарды тізбеге алуға болады.</p>
<p>Басқа бір мысал - команда жолындағы параметрлерді алу. Бұл есекше жатты кезде ауызды болуы мүмкін (және өмірінде жаман болады), бірақ сіз встроен escapeshellarg() функциясын пайдалана аласыз деп сенімдесеңіз, ол іске асырылған команда аргументтерін сызгытауға болады.</p>
<p>Соңғы мысал, файлды файл жүктеу үшін сыртқы кірісін алу. Бұл файл атауын файл пайда бола алатыні, атауны файл жолына өзгерту арқылы. Файл жолынан “/”, “…/”, <a href="https://www.php.net/security.filesystem.nullbytes">null байттар</a> немесе басқа арнайы символдарды алауып тастауыңыз көмек етеді, сондықтан ол көзге жатпауларды, жасырын, жеке немесе ерекше файлдарды жүктемейді.</p>
<ul>
<li><a href="https://www.php.net/book.filter">Деректерді сүзгіту туралы білім алу</a></li>
<li><a href="https://www.php.net/function.filter-var">filter_var туралы білім алу</a></li>
<li><a href="https://www.php.net/function.filter-input">filter_input туралы білім алу</a></li>
<li><a href="https://www.php.net/security.filesystem.nullbytes">null байттарды өңдеу туралы білім алу</a></li>
</ul>
<h3 id="санитарлау">Санитарлау</h3>
<p>Санитарлау сыртқы кірістерден (немесе шектеуленген) немесе қауіпті тағыларды алып тастайды.</p>
<p>Мысалы, сіз сыртқы кірістерді HTML-де қосу немесе оны түйінді SQL сұрауына кірістіруді алдында санитарлау қажет. <a href="https://phptherightway.com/#databases">PDO</a> менен байланысатын параметрлерді пайдаланғанда, ол сізге осындай кірістерді санитарлау жасайды.</p>
<p>Кейде, оны HTML бетіне қосу кезінде кейбір қауіпті HTML тегтерге рұқсат беру қажет болады. Бұл көмек көп жұмыс істеуі келетін және басқаша ортақ форматтауларды қолдану арқылы істеуі жатты жасалатын болады, себебі Markdown немесе BBCode түрлерінде шектеуленген көмек көрсету талап етеді, бірақ бұл мақсатта жасалған <a href="http://htmlpurifier.org/">HTML Purifier</a> ұстануларының орналасқан библиотектері менен пайдалануы мүмкін.</p>
<p><a href="https://www.php.net/filter.filters.sanitize">Санитарлау фильтрлеріне қарау</a></p>
<h3 id="ашылымдандыру">Ашылымдандыру</h3>
<p>Пайдаланушылардан немесе басқа сенімделген келістіктерден деректерді unserialize() функциясы арқылы ашу қауіпті. Бұлып, халықаралық пайдаланушыларды бұзушыларды, объектілерді (пайдаланушының анықтамаларымен) құрып алуына рұқсат береді, объекттерді пайдаланбаса да. Сондықтан сенімделген деректерді ашу мүмкіндігінен беттер алау қажет.</p>
<p>Пайдаланушыға сериализацияланған деректерді алу кезінде JSON (<a href="https://www.php.net/manual/function.json-decode.php">json_decode</a> және <a href="https://www.php.net/manual/function.json-encode.php">json_encode</a> арқылы) дайындама форматын пайдалану сәтті өтірік болады.</p>
<h3 id="конфигурация-файлдары">Конфигурация файлдары</h3>
<p>Сіздің қолданбалары үшін конфигурация файлдарын жасау кезінде ең жақсы әдістерге сай етіледі:</p>
<ul>
<li>Конфигурация ақпаратыны сіздік файл жүйесі арқылы тіркесуденген жерде сақтау көмек көрсетіледі.</li>
<li>Егер сіз конфигурация файлдарын құжат тұтынуымен сақтау көзден жатса, файлдарды .php кешимен атауымен атырып жатсаңыз. Бұл оқиға өзінен скрипт тіркесімге дайын кіруге болса, ол тұрау түрінде шықарылмайды.</li>
<li>Конфигурация файлдарындағы ақпаратты өте жақсы қорғау көмек көрсетуіміз керек, себебі оларға шифрлау немесе топ/пайдаланушы файл жүйесіның рұқсаттары арқылы.</li>
<li>Жалпы контролді файлдардың ішінде сіздің өзіңізге арналған ақпаратты мұрағаттау үшін мақсаттанған конфигурация файлдарын жүктемемеуімізді рекомендайлайды (мысалы, құпия сөздер немесе API тауарлары).</li>
</ul>
<h3 id="тіркеулі-global-дарындар">Тіркеулі Global-дарындар</h3>
<p>ЕСІК: PHP 5.4.0-дан бастап register_globals параметрі аластатылды және қолданбау жасауға болмайды. Бұл тек жатталма жасау процесінде болатын адамдарға көмек көрсету үшін көрсетілген.</p>
<p>Қосылғанда, register_globals баптауы параметрі сіздің қолдау жасауыныздың өзгеше қасиеттерін (мысалы, $_POST, $_GET және $_REQUEST) сіздік қолдарыңызда қол жетімді етеді. Бұл сіздің өтінішіңізнің мәнінің қайсысынан келгенін эффективді түсіну мүмкіндігі жоқ боларының себебімен қауіптік ситуацияларға әкеп кету мүмкін.</p>
<p>Мысалы: $_GET[‘foo’] $foo арқылы қол жеткізіледі, мысалы, басқа анықталған өріс бойынша.</p>
<p>Егер сіз PHP &lt; 5.4.0 пайдалана алатын болсаңыз, регистр_глобалс параметрінің орнатылмауына сенімді болыңыз.</p>
<h3 id="қате-еске-алу">Қате еске алу</h3>
<p>Қате еске алу жасауыңыздың проблемалы нүктелерін табуға көмек көрсете алады, бірақ бұл сіздің қолдарыңызды тышқан өзге адамдарға тіркеме бере алады. Бұл хабарламалардың шығарылуының туындылығымен туғыздау болса да, олардың шығарылуымен туындылықтың жағдайларына тиіс алу үшін көзілдірілген жасауларыңызды дайындау керек (дайындау жасау жылында).</p>
<h4 id="дайындау">Дайындау</h4>
<p>Дайындауда көрсетілетін өзге өрістерді көзілдету үшін php.ini файлының жалпы настройкаларын көзілдетіңіз:</p>
<pre><code>display_errors = Оn
display_startup_errors = Оn
error_reporting = -1
log_errors = Оn
</code></pre>
<p>-1 мәнін орнату осып жаттығуларды көрсетеді, сонымен қатар жаттығулар таңдауланбаған пайдаланба жаңа PHP нұсқаларында. PHP 5.4-тен бастап E_ALL константасы да мынау жаттығуларды көрсетеді. - <a href="http://php.net">php.net</a></p>
<p>E_STRICT жаттығуларды таңдау жаттығу константасы 5.3.0 нұсқасында енгізілді және E_ALL бөлігі емес, бірақ ол 5.4.0 нұсқасында E_ALL бөлігінің бір бөлігі болды. Бұл не маані? 5.3 нұсқасында барлық мүмкін ерекше қателерді хабарлау күтімінде сізге -1 не E_ALL | E_STRICT мәнін пайдалануыңыз керек.</p>
<h3 id="php-нұсқасы-бойынша-барлық-мүмкін-қателерді-хабарлау">PHP нұсқасы бойынша барлық мүмкін қателерді хабарлау</h3>
<ul>
<li>&lt; 5.3 -1 or E_ALL</li>
<li>5.3 -1 or E_ALL | E_STRICT</li>
<li>‘&gt; 5.3 -1 or E_ALL’</li>
</ul>
<h3 id="өндіру">Өндіру</h3>
<p>Өндіру атмосферасында қателерді жасыру үшін php.ini файлын көзілдетіңіз:</p>
<p>display_errors = Off<br>
display_startup_errors = Off<br>
error_reporting = E_ALL<br>
log_errors = On<br>
Бұл настройкалармен өндіріс жасау жылында қателер веб-сервердің қателерді жазудың журналына жазыларына тіркеледі, бірақ пайдаланушыға көрсетілмейді. Осы настройкалар туралы толық ақпарат алу үшін PHP мануалына қарау:</p>
<ul>
<li><a href="https://www.php.net/errorfunc.configuration#ini.error-reporting">error_reporting</a></li>
<li><a href="https://www.php.net/errorfunc.configuration#ini.display-errors">display_errors</a></li>
<li><a href="https://www.php.net/errorfunc.configuration#ini.display-startup-errors">display_startup_errors</a></li>
<li><a href="https://www.php.net/errorfunc.configuration#ini.log-errors">log_errors</a></li>
</ul>
</div>
</body>

</html>
